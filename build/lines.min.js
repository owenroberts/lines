!function(){"use strict";Array.prototype.insert=function(t,e){this.splice(t,0,e)},Number.prototype.clamp=function(t,e){return Math.min(Math.max(this,t),e)},"undefined"!=typeof window&&(window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){window.setTimeout(t,1e3/60)});const t={map:function(t,e,i,n,s){return n+(s-n)*(t-e)/(i-e)||0},padNumber:function(t,e){let i=""+t;for(;i.length<e;)i="0"+i;return i},random:function(e,i){return i?Math.random()*(i-e)+e:"number"==typeof e?Math.random()*e:Array.isArray(e)?e[Math.floor(Math.random()*e.length)]:"object"==typeof e?e[t.random(Object.keys(e))]:void 0},randomInt:function(t,e){return e||(e=t,t=0),Math.round(Math.random()*(e-t)+t)},chance:function(e){return t.random(1)<e},choice:function(t){return Array.isArray(t)||(t=[...arguments]),t[Math.floor(Math.random()*t.length)]},shuffle:function(t){let e,i=t.length;for(;0!=i;)e=Math.floor(Math.random()*i),i--,[t[i],t[e]]=[t[e],t[i]];return t},randomNormalInverse:function(){let e=0,i=0;for(;0===e;)e=Math.random();for(;0===i;)i=Math.random();const n=Math.sqrt(-2*Math.log(e))*Math.cos(2*Math.PI*i);let s=t.map(n,-3.5,3.5,0,1);return s>.5?s-.5:s+.5},componentToHex:function(t){var e=t.toString(16);return 1==e.length?"0"+e:e},HueToRgb:function(t,e,i){return i<0?i+=1:i>1&&(i-=1),255*(6*i<1?t+(e-t)*i*6:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t)},hslToHex:function(t){for(var e=0,i=0,n=0,s=0,a=0,o=0,h=0;a<t.length;a++){var d=t.charCodeAt(a);if(d>=48&&d<=57)s=10*s+(d-48),h=1;else{if(1===h){switch(o){case 0:e=s%360/360;break;case 1:i=(s>100?100:s)/100;break;case 2:n=(s>100?100:s)/100}o++}h=0,s=0}}var l=e/(1/6),c=(t=(1-Math.abs(2*n-1))*i)*(1-Math.abs(l%2-1));switch(0|l){case 0:r=t,g=c,b=0;break;case 1:r=c,g=t,b=0;break;case 2:r=0,g=t,b=c;break;case 3:r=0,g=c,b=t;break;case 4:r=c,g=0,b=t;break;case 5:r=t,g=0,b=c}var u=n-.5*t;r+=u,g+=u,b+=u,r=255*r|0,g=255*g|0,b=255*b|0;var m="";return(h=48+(r>>4&15))>57&&(h+=7),m+=String.fromCharCode(h),(h=48+(15&r))>57&&(h+=7),m+=String.fromCharCode(h),(h=48+(g>>4&15))>57&&(h+=7),m+=String.fromCharCode(h),(h=48+(15&g))>57&&(h+=7),m+=String.fromCharCode(h),(h=48+(b>>4&15))>57&&(h+=7),m+=String.fromCharCode(h),(h=48+(15&b))>57&&(h+=7),m+=String.fromCharCode(h)},hexToRgb:function(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null},rgbToHsl:function(t){t.r/=255,t.g/=255,t.b/=255;var e,i,n=Math.max(t.r,t.g,t.b),s=Math.min(t.r,t.g,t.b),r=(n+s)/2;if(n==s)e=i=0;else{var a=n-s;switch(i=r>.5?a/(2-n-s):a/(n+s),n){case t.r:e=(t.g-t.b)/a+(t.g<t.b?6:0);break;case t.g:e=(t.b-t.r)/a+2;break;case t.b:e=(t.r-t.g)/a+4}e/=6}return[360*e+.5|0,100*i+.5|0,100*r+.5|0]},rgb2hex:function(t){var e=t.replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+)/i);return e&&4===e.length?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):t},keys:{9:"tab",13:"enter",27:"escape",32:"space",37:"left",38:"up",39:"right",40:"down",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",186:";",187:"+",188:",",190:".",191:"/",192:"`",219:"[",220:"backslash",221:"]",222:"'"},Vector:function(e,i){return this.x=e||0,this.y=i||0,Array.isArray(this.x)&&(this.x=e[0],this.y=e[1]),this.random=function(e,i,n,s){return 1==arguments.length?(this.x=t.random(-e,e),this.y=t.random(-e,e)):2==arguments.length?(this.x=t.random(e,i),this.y=t.random(e,i)):4==arguments.length?(this.x=t.random(e,i),this.y=t.random(n,s)):console.error("You need 1, 2 or 4 arguments, dingus."),this},this.zero=function(){return!(Math.abs(this.x)>0||Math.abs(this.y)>0)},this.add=function(t){return this.x+=t.x,this.y+=t.y,this},this.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},this.multiply=function(t){return"object"==typeof t?(this.x*=t.x,this.y*=t.y):(this.x*=t,this.y*=t),this},this.divide=function(t){return"object"==typeof t?(this.x/=t.x,this.y/=t.y):(this.x/=t,this.y/=t),this},this.magnitude=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},this.normalize=function(){var t=this.magnitude();return 0!=t&&1!=t&&this.divide(t),this},this.copy=function(){return new t.Vector(this.x,this.y)},this.distance=function(e){var i=new t.Vector(e.x,e.y);return i.subtract(this),i.magnitude()},this.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},this.getObj=function(){return{x:this.x,y:this.y}},this.clone=function(){return new t.Vector(this.x,this.y)},this.sameDirection=function(t){return Math.sign(this.x)==Math.sign(t.x)&&Math.sign(this.y)==Math.sign(t.y)},this.toArray=function(){return[this.x,this.y]},this},mobilecheck:function(){var t,e=!1;return t=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0),e},testPerformance:function(){for(var t=new Date,e=15e7,i=e;i>0;i--);var n=new Date,s=Number(String(n.getSeconds())+"."+String(n.getMilliseconds()))-Number(String(t.getSeconds())+"."+String(t.getMilliseconds()));return t.getMinutes()!=n.getMinutes()&&(s=60*(n.getMinutes()-t.getMinutes())+s),spd=1.734/s,Math.round(1e3*s)/1e3}};"undefined"!=typeof module&&(module.exports=t),"undefined"!=typeof window&&(window.Cool=t);window.Lines={},window.Lines.Animation=class{constructor(t,e,i,n){this.ctx=t,this.isLoaded=!1,this.isPlaying=!1,this.multiColor=i||!1,this.multiWidth=n||!1,this.drawings=[],this.layers=[],e||(e=30),this._fps=30===e?10:12,this.drawsPerFrame=Math.round(e/this._fps),this.currentFrame=0,this.drawCount=0,this.override={},this._state="default",this.states={default:{start:0,end:0}},this.layerColor,this.suspendUpdate=!1,this.init&&this.init()}randomCount(){this.drawCount=t.randomInt(this.drawsPerFrame)}set fps(t){const e=this.fps*this.dpf;let i=e/+t;i%1>0&&(i=1===Math.abs(+t-this._fps)?this.dpf+Math.sign(this.fps-+t):Math.round(i)),this.drawsPerFrame=i,this._fps=+(e/this.dpf).toFixed(3),this.drawCount=0}get fps(){return this._fps}set dpf(t){const e=this.fps*this.dpf;this.drawsPerFrame=+t,this._fps=e/this.drawsPerFrame}get dpf(){return this.drawsPerFrame}get frame(){return this.currentFrame}set frame(t){this.currentFrame=+t,this.states.default&&this.states.default.end!==this.endFrame&&(this.states.default.end=this.endFrame)}get endFrame(){const t=this.layers.map((t=>t.endFrame));return Math.max.apply(Math,t)}set endFrame(t){this.layers.forEach((e=>{e.endFrame=t}))}set state(t){this._state!==t&&this.states[t]&&(this._state=t,this.state&&(this.frame=this.state.start))}get state(){return this.states[this._state]}get stateName(){return this._state}setLinesUpdate(t){this.layers.forEach((e=>{e.linesInterval=t}))}overrideProperty(t,e){this.override[t]=e}cancelOverride(){this.override={}}update(){this.isPlaying&&(this.drawCount===this.drawsPerFrame?(this.currentFrame>=this.state.end?(this.currentFrame=this.state.start,this.onPlayedState&&this.onPlayedState(),this.onPlayedOnce&&this.onPlayedOnce()):this.currentFrame++,this.drawCount=0):this.drawCount++,this.onUpdate&&this.onUpdate())}finish(t){this.ctx.stroke()}setColor(t){this.ctx.strokeStyle!==t&&(this.ctx.strokeStyle=t)}getColor(){return this.ctx.strokeStyle}getLayers(){let t=[];for(let e=0,i=this.layers.length;e<i;e++)this.layers[e].isInFrame(this.currentFrame)&&t.push(this.layers[e]);return t}getCurrentProps(){return{color:this.ctx.strokeStyle,lineWidth:this.ctx.lineWidth}}draw(e,i,n){let s=this.getCurrentProps();this.ctx.beginPath();const r=this.getLayers();for(let a=0,o=r.length;a<o;a++){const o=r[a],h=this.drawings[o.drawingIndex],d=o.drawProps;if(e&&(d.x+=e),i&&(d.y+=i),d.tweens.length)for(let e=0;e<d.tweens.length;e++){const i=d.tweens[e];i.startFrame<=this.currentFrame&&i.endFrame>=this.currentFrame&&(d[i.prop]=t.map(this.currentFrame,i.startFrame,i.endFrame,i.startValue,i.endValue),"startIndex"!==i.prop&&"endIndex"!==i.prop&&"segmentNum"!==i.prop||(d[i.prop]=Math.round(d[i.prop])))}for(const t in this.override)d[t]=this.override[t];h.firstUpdate?(h.firstUpdate=!1,h.update(d)):n||this.suspendUpdate||(o.linesCount>=o.linesInterval&&h.needsUpdate?(h.update(d),o.linesCount=0):h.needsUpdate&&o.linesCount++),(this.multiColor||this.multiWidth)&&(d.color===s.color&&d.lineWidth===s.lineWidth||(this.finish(),d.color!==s.color&&(this.setColor(d.color),s.color=d.color),d.lineWidth!==s.lineWidth&&(this.ctx.lineWidth!==d.lineWidth&&(this.ctx.lineWidth=d.lineWidth),s.lineWidth=d.lineWidth),this.ctx.beginPath()));let l=d.endIndex<0?h.length-1:d.endIndex-1;for(let t=d.startIndex;t<l;t++){const e=h.get(t);if("end"===e[0]||"add"===e[0])continue;let i=h.get(t+1);if("end"!==i[0]){if("add"===i[0]){i=h.get(0);for(let e=t;e>0;e--){let t=h.get(e)[0];if("end"===t||"add"===t){i=h.get(e+1);break}}}this.drawLines(e,i,d)}}}this.finish(),this.onDraw&&this.onDraw()}drawLines(t,e,i){if(void 0===t[0])return;if(void 0===e[0])return;if(this.ctx.moveTo(i.x+t[0][0]+t[1][0][0],i.y+t[0][1]+t[1][0][1]),1===i.segmentNum)return void this.ctx.lineTo(i.x+e[0][0]+e[1][0][0],i.y+e[0][1]+e[1][0][1]);const n=[(e[0][0]-t[0][0])/i.segmentNum,(e[0][1]-t[0][1])/i.segmentNum];for(let s=1;s<i.segmentNum;s++){const r=[t[0][0]+n[0]*s,t[0][1]+n[1]*s];let a=[0,0];s!==i.segmentNum-1||i.breaks?t[1][s]&&(a=t[1][s],a||console.log("else k",s,a,t,e)):a=e[1][0],this.ctx.lineTo(i.x+r[0]+n[0]+a[0],i.y+r[1]+n[1]+a[1])}}load(t,e){"object"==typeof t?loadJSON(t,e):fetch(t).then((t=>t.json())).then((t=>{this.loadData(t,e)})).catch((t=>{console.error(t)}))}loadJSON(t,e){this.loadData(t,e)}loadData(t,e){this.isLoaded=!0;for(let e=0;e<t.d.length;e++)this.drawings[e]=t.d[e]?new i(t.d[e]):null;const s=Math.round(5*Math.random());for(let e=0;e<t.l.length;e++){const i=this.loadParams(t.l[e]);i.drawingEndIndex=this.drawings[i.drawingIndex].length,i.linesCount=s;const r=new n(i);this.layers[e]=r}for(const e in t.s)this.states[e]={start:t.s[e][0],end:t.s[e][1]};this.states.default&&(this.states.default.end=this.endFrame),this.fps=t.fps,t.mc&&(this.multiColor=t.mc),t.mw&&(this.multiWidth=t.mw),this.width=t.w,this.height=t.h,this.halfWidth=Math.round(t.w/2),this.halfHeight=Math.round(t.h/2),e&&e(t),this.onLoad&&this.onLoad()}loadParams(t){const e={drawingIndex:t.d,startFrame:t.f[0],endFrame:t.f[1],x:t.x||0,y:t.y||0,color:t.c,lineWidth:t.lw||1,segmentNum:t.n,jiggleRange:t.r,wiggleRange:t.w,wiggleSpeed:t.v,wiggleSegments:t.ws,breaks:t.b||!1,linesInterval:t.l||5,groupNumber:t.g};return t.t&&(e.tweens=t.t.map((t=>({prop:t[0],startFrame:t[1],endFrame:t[2],startValue:t[3],endValue:t[4]})))),t.o&&(e.order=t.o),e}setOnLoad(t){this.isLoaded?t():this.onLoad=t}play(){this.isPlaying=!0}stop(){this.isPlaying=!1}};window.Lines.Animator=class{constructor(t,e){this.animation=t,this.params={segmentNum:[1,5],jiggleRange:[0,9],wiggleRange:[0,10],wiggleSpeed:[0,4],linesInterval:[1,10],startIndex:[0,"end"],endIndex:[0,"end"],...e}}update(){this.animation.layers.forEach((e=>{if(e.tweens.length){const t=e.tweens[0].prop;["startIndex","endIndex"].includes(t)||(e[t]=e.tweens[0].endValue)}e.tweens=[];const i=t.choice(...Object.keys(this.params));if("startIndex"===i||"endIndex"===i){const t={prop:i,startFrame:0,endFrame:this.animation.endFrame,startValue:0,endValue:this.animation.drawings[e.drawingIndex].length-1};e.tweens.push(t)}else if(t.chance(.5))e[i]=t.randomInt(this.params[i][0],this.params[i][1]);else{const n={prop:i,startFrame:0};n.endFrame=this.animation.endFrame,n.startValue=e[i],n.endValue=t.randomInt(this.params[i][0],this.params[i][1]),e.tweens.push(n)}}))}};const e={init(){this.antiFactor=GAME.antiFactor},drawLines(t,e,i){if(this.ctx.moveTo((i.x+t[0][0]+t[1][0][0])*this.antiFactor,(i.y+t[0][1]+t[1][0][1])*this.antiFactor),1===i.segmentNum)return void this.ctx.lineTo((i.x+e[0][0]+e[1][0][0])*this.antiFactor,(i.y+e[0][1]+e[1][0][1])*this.antiFactor);const n=[(e[0][0]-t[0][0])/i.segmentNum,(e[0][1]-t[0][1])/i.segmentNum];for(let s=1;s<i.segmentNum;s++){const r=[t[0][0]+n[0]*s,t[0][1]+n[1]*s];let a=[0,0];s!==i.segmentNum-1||i.breaks?t[1][s]&&(a=t[1][s],a||console.log("else k",s,a,t,e)):a=e[1][0],this.ctx.lineTo((i.x+r[0]+n[0]+a[0])*this.antiFactor,(i.y+r[1]+n[1]+a[1])*this.antiFactor)}}};window.Lines.AntiMixin=e;class i{constructor(t){if(this.points=[],this.offsets=[],t)for(let e=0;e<t.length;e++)this.add(t[e]);this.lastDrawCount=0,this.firstUpdate=!0}add(t){"add"===t||1===t?this.points.push("add"):"end"===t||0===t?this.points.push("end"):Array.isArray(t)?this.points.push(t):this.points.push([t.x,t.y]),this.offsets.push([[0,0],[0,0]])}pop(){return this.offsets.pop(),this.points.pop()}shift(){return this.offsets.shift(),this.points.shift()}get(t){return t<0?[this.points[this.points.length+t],this.offsets[this.offsets.length+t]]:[this.points[t],this.offsets[t]]}get length(){return this.points.length}get needsUpdate(){return this.lastDrawCount<drawCount&&(this.lastDrawCount=drawCount,!0)}update(e){const i=[t.random(-e.wiggleSpeed,e.wiggleSpeed),t.random(-e.wiggleSpeed,e.wiggleSpeed)],n=[t.random(0,e.wiggleRange),t.random(0,e.wiggleRange)];for(let s=0,r=this.points.length;s<r;s++)if("end"!==this.points[s]){this.offsets[s]=[];for(let r=0;r<e.segmentNum;r++)e.wiggleRange>0&&(0===r||e.wiggleSegments)&&(n[0]+=i[0],n[1]+=i[1],(n[0]>=e.wiggleRange||n[0]<=-e.wiggleRange)&&(i[0]*=-1),(n[1]>=e.wiggleRange||n[1]<=-e.wiggleRange)&&(i[1]*=-1)),this.offsets[s].push([t.random(-e.jiggleRange,e.jiggleRange)+n[0],t.random(-e.jiggleRange,e.jiggleRange)+n[1]])}}}window.Lines.Drawing=i;class n{constructor(t,e){this.drawingIndex=t.drawingIndex,this.tweens=t.tweens||[],this.x=t.x||0,this.y=t.y||0,this._startFrame=t.startFrame,this._endFrame=t.endFrame||t.startFrame,this.drawingStartIndex=t.drawingStartIndex||0,this.drawingEndIndex=t.drawingEndIndex||-1,this.color=t.color||"#000000",this.lineWidth=t.lineWidth||1,this.segmentNum=t.segmentNum,this.jiggleRange=t.jiggleRange,this.wiggleRange=t.wiggleRange,this.wiggleSpeed=t.wiggleSpeed,this.wiggleSegments=t.wiggleSegments||!1,this.breaks=t.breaks||!1,this.linesInterval=t.linesInterval,this.linesCount=t.linesCount||0,this.init&&this.init(t)}get startFrame(){return this._startFrame}set startFrame(t){this._startFrame=Math.max(0,+t)}get endFrame(){return this._endFrame}set endFrame(t){this._endFrame=Math.max(0,+t)}isInFrame(t){return t>=this.startFrame&&t<=this.endFrame}get drawProps(){const t={segmentNum:this.segmentNum,jiggleRange:this.jiggleRange,wiggleRange:this.wiggleRange,wiggleSpeed:this.wiggleSpeed,wiggleSegments:this.wiggleSegments,x:this.x,y:this.y,color:this.color,lineWidth:this.lineWidth,startIndex:this.drawingStartIndex,endIndex:this.drawingEndIndex,breaks:this.breaks,linesInterval:this.linesInterval};return this.tweens&&(t.tweens=this.tweens),t}}window.Lines.Layer=n,window.Lines.Loader=function(t){let e,i=t.debug||!1,n=t.relativeLoadPath,s=(t.saveAnimationData,{});function r(t,i,r){n&&(r="."+r),fetch(r).then((t=>t.json())).then((n=>{s[t][i].json=n,s[t][i].src=r,s[t][i].isLoaded=!0,function(){let t=!0;for(const e in s)for(const i in s[e])s[e][i].isLoaded||(t=!1);t&&(e(s),e=void 0)}()}))}function a(t){if(t.ok)return t.url.includes("csv")?t.text():t.json();throw new Error("Network response error")}function o(t,e,i){if("object"==typeof e){s[t]={};for(const n in e)s[t][n]={},s[t][n].data=e[n],s[t][n].isLoaded=!!i,r(t,n,e[n].src)}else{const i=CSVToArray(e,",").splice(0),n=i[0];s[t]={items:[]};for(let e=1;e<i.length;e++){const a={isLoaded:!1};for(let t=0;t<n.length;t++)a[n[t]]=i[e][t];s[t].items.push(a),r(t,a.label,`drawings/${t}/${a.label}.json`)}}}function h(t,e){console.error("file load error",t),console.log(data,e),s[e].loaded=!0}return{load:function(t,n,r){i&&console.log("loading data"),i&&console.time("load data"),e=r;for(const e in t){const i=t[e];s[e]={loaded:!1},fetch(i).then((t=>a(t))).then((t=>{o(e,t,n)})).catch((t=>{h(t,e)}))}},getAnimation:function(t,e){return s[t][e].animation},getAnimationData:function(t,e){return s[t][e]},getFile:function(t){return s[t]}}};const s={init(){this.pixelSize=GAME.pixelSize||GAME.lineWidth||2},finish(){this.ctx.fill()},setColor(t){this.ctx.fillStyle!==t&&(this.ctx.fillStyle=t)},getColor(){return this.ctx.fillStyle},drawLines(t,e,i){if(1===i.segmentNum)this.simplePixelLine(i.x+t[0][0]+t[1][0][0],i.y+t[0][1]+t[1][0][1],i.x+e[0][0]+t[1][1][0],i.y+e[0][1]+t[1][1][1]);else{const n=[(e[0][0]-t[0][0])/i.segmentNum,(e[0][1]-t[0][1])/i.segmentNum];for(let s=0;s<i.segmentNum;s++){const r=[t[0][0]+n[0]*s,t[0][1]+n[1]*s],a=[t[0][0]+n[0]*(s+1),t[0][1]+n[1]*(s+1)];let o=[0,0];s!==i.segmentNum-1||i.breaks?t[1][s]&&(o=t[1][s],o||console.log("else k",s,o,t,e)):o=e[1][0],this.simplePixelLine(i.x+r[0]+o[0],i.y+r[1]+o[1],i.x+a[0]+o[0],i.y+a[1]+o[1])}}},simplePixelLine(t,e,i,n){t=Math.round(t/this.pixelSize),e=Math.round(e/this.pixelSize),i=Math.round(i/this.pixelSize),n=Math.round(n/this.pixelSize);let s=Math.abs(i-t),r=Math.abs(n-e),a=t<i?1:-1,o=e<n?1:-1,h=s-r;for(;this.ctx.rect(t*this.pixelSize,e*this.pixelSize,this.pixelSize,this.pixelSize),t!==i||e!==n;){let i=2*h;i>-r&&(h-=r,t+=a),i<s&&(h+=s,e+=o)}},pixelLine(t,e,i,n){const s=this.ctx.lineWidth;t=Math.round(t),i=Math.round(i),e=Math.round(e),n=Math.round(n);const r=Math.abs(i-t),a=t<i?1:-1,o=Math.abs(n-e),h=e<n?1:-1;let d,l,c,g=r;if(r>o){if(d=r/2,c=t>i?1:0,o>1){d=0,g=o-1;do{l=d/o+2|0,this.ctx.rect(t-l*c,e,l,s),t+=l*a,e+=h,d-=l*o-r}while(g--)}d>0&&this.ctx.rect(t,n,i-t,s)}else if(r<o){if(d=o/2,c=e>n?1:0,r>1){d=0,g--;do{l=d/r+2|0,this.ctx.rect(t,e-l*c,s,l),e+=l*h,t+=a,d-=l*r-o}while(g--)}d>0&&this.ctx.rect(i,e,s,n-e)}else do{this.ctx.rect(t,e,s,s),t+=a,e+=h}while(g--)}};window.Lines.PixelMixin=s,window.Lines.Renderer=function(t){let i=t.id||"lines",n=t.dps||30,r=void 0===t.retina||t.retina,a=Math.max(1,r&&window.devicePixelRatio||1),o=t.scale||1,h=t.lineWidth||1,d=t.bgColor||t.bg||!1,l=t.multiColor||!1,c=t.width,g=t.height,u=void 0===t.clearBg||t.clearBg;const m=document.getElementById(i);m||(m=document.createElement("canvas"),m.id=i,document.body.appendChild(this.canvas));const p=m.getContext("2d");if(!p)return alert("No canvas context??");if(p.lineWidth=h,t.lineColor&&(this.ctx.strokeStyle=t.lineColor),S(),d&&(m.style.backgroundColor=d),c&&(m.width=c*a*o),g&&(m.height=g*a*o),t.zoom||a>1){t.zoom;m.style.width=c+"px",m.style.height=g+"px"}if(t.usePixels&&Object.assign(Lines.prototype,s),t.antiFactor&&(Object.assign(Lines.prototype,e),m.width=c*a*t.antiFactor,m.height=g*a*t.antiFactor,t.smallCanvas&&(m.style.width=c*a+"px",m.style.height=g*a+"px"),p.lineWidth=h*t.antiFactor),t.svgFilter){const t="http://www.w3.org/2000/svg",e=document.createElementNS(t,"svg"),i=document.createElementNS(t,"defs"),n=document.createElementNS(t,"filter"),s=document.createElementNS(t,"feComponentTransfer"),r=document.createElementNS(t,"feFuncA");e.setAttribute("style","position:absolute;z-index:-1;"),e.setAttribute("width","0"),e.setAttribute("height","0"),document.body.appendChild(e),e.appendChild(i),i.appendChild(n),n.setAttribute("id","remove-alpha"),n.setAttribute("x","0"),n.setAttribute("y","0"),n.setAttribute("width","100%"),n.setAttribute("height","100%"),n.appendChild(s),s.appendChild(r),r.setAttribute("type","discrete"),r.setAttribute("tableValues","0 1"),p.filter="url(#remove-alpha)"}window.drawCount=0;let f,w=1e3/(t.frameRate||60),x=performance.now(),b=!1;const y=[],v=[],F=[];function M(t){c=t,m.width=c*a*o,C()}function k(t){g=t,m.height=g*a*o,C()}function S(){p.miterLimit=1,p.lineCap="round",p.lineJoin="round"}function C(){p.scale(1,1),p.scale(a*o,a*o),p.lineWidth=h,S()}function I(t){if(f=t-x,f>w||"capture"===t){x=t-f%w,u&&p.clearRect(0,0,m.width,m.height);for(let t=0;t<y.length;t++)y[t](f);window.drawCount++}b||window.requestAnimFrame(I)}return{canvas:m,ctx:p,reset:C,start:function(){C(),x=performance.now(),window.requestAnimFrame(I),b&&(b=!1)},suspend:function(){b=!0},update:I,addCallback:function(t,e){e&&"callback"!==e||y.push(t),"pre"===e&&F.push(t),"post"===e&&v.push(t)},setSuspend:function(t){b=t},setWidth:M,setHeight:k,setScale:function(t){o=t,M(c),k(g)},setDPS:function(t){n=t,w=1e3/n},setLineWidth:function(t){h=t,p.lineWidth=h,S()},getProps:()=>({width:c,height:g,scale:o,lineWidth:h,bgColor:d,dps:n,multiColor:l})}}}();
//# sourceMappingURL=src_maps/lines.min.js.map
